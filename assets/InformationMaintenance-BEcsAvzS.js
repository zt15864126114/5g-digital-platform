import{_ as xe,r as p,l as J,c as f,b as l,w as a,d as s,e as c,F as z,g as B,f as n,h as u,t as r,D as ze,m as Q,n as Be,i as T,B as R,E as De,p as D,q as Me,j as Ue,A as Fe,s as Se,y as Te}from"./index-B0E1bweF.js";const Re={class:"maintenance-container"},Ae={class:"stat-icon"},Ie={class:"stat-info"},$e={class:"stat-title"},qe={class:"card-header"},Ee={class:"header-left"},Le={class:"header-right"},He={class:"pagination-container"},Ke={class:"dialog-footer"},Pe={key:0,class:"detail-content"},Ne={class:"meta-info"},je={class:"content-box"},Oe={key:0,class:"attachments-section"},Ge={class:"attachment-list"},Je={key:1,class:"approval-section"},Qe={class:"dialog-footer"},We={__name:"InformationMaintenance",setup(Xe){const W=[{title:"总记录数",value:256,icon:"Document",color:"#409EFF"},{title:"本月更新",value:45,icon:"Refresh",color:"#67C23A"},{title:"待审核",value:8,icon:"Timer",color:"#E6A23C"},{title:"已驳回",value:3,icon:"CircleClose",color:"#F56C6C"}],g=p([{id:1,date:"2024-10-20",type:"产品信息",title:"5G网络切片产品更新说明",operator:"张工",category:"产品文档",status:"已审核",content:`本次更新包含以下内容：
1. 优化网络切片配置流程
2. 新增自动化部署功能
3. 提升性能监控准确度`,attachments:[{name:"产品说明书v2.1.pdf",size:"2.5MB"}]},{id:2,date:"2024-10-19",type:"技术文档",title:"API接口文档更新",operator:"李工",category:"开发文档",status:"待审核",content:`更新了以下API接口文档：
1. 用户认证接口
2. 数据统计接口
3. 配置管理接口`,attachments:[{name:"API文档v1.2.md",size:"856KB"},{name:"接口示例.json",size:"128KB"}]}]),v=p({type:"",title:"",category:"",content:"",attachments:[]}),X={type:[{required:!0,message:"请选择信息类型",trigger:"change"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},_=p({result:"通过",comment:""}),Y={result:[{required:!0,message:"请选择审核结果",trigger:"change"}],comment:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},Z=p(!1),V=p(!1),M=p("add"),A=p(!1),k=p(!1),i=p(null),U=p(""),h=p(1),I=p(10),$=p(null),q=p(null),H=J(()=>g.value.length),ee=J(()=>{let o=g.value;if(U.value){const e=U.value.toLowerCase();o=o.filter(d=>d.title.toLowerCase().includes(e)||d.operator.toLowerCase().includes(e)||d.content.toLowerCase().includes(e))}return o}),te=[{label:"产品信息",value:"产品信息"},{label:"技术文档",value:"技术文档"},{label:"运维信息",value:"运维信息"},{label:"市场动态",value:"市场动态"}],le=[{label:"产品文档",value:"产品文档"},{label:"开发文档",value:"开发文档"},{label:"系统公告",value:"系统公告"},{label:"操作手册",value:"操作手册"}],ae=o=>({产品信息:"success",技术文档:"primary",运维信息:"warning",市场动态:"info"})[o]||"",oe=o=>({产品文档:"success",开发文档:"primary",系统公告:"warning",操作手册:"info"})[o]||"",K=o=>({已审核:"success",待审核:"warning",已驳回:"danger"})[o]||"",ne=()=>{M.value="add",v.value={type:"",title:"",category:"",content:"",attachments:[]},V.value=!0},se=o=>{M.value="edit",v.value={...o},V.value=!0},ue=o=>{i.value=o,A.value=!0},re=o=>{De.confirm("确认删除该记录吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=g.value.findIndex(d=>d.id===o.id);e>-1&&(g.value.splice(e,1),D.success("删除成功"))}).catch(()=>{})},ie=o=>{i.value=o,_.value={result:"通过",comment:""},k.value=!0},P=()=>{h.value=1},de=o=>{I.value=o,h.value=1},pe=o=>{h.value=o},ce=(o,e)=>{console.log(o,e)},ve=o=>{D.success(`开始下载文件：${o.name}`)},me=async()=>{$.value&&await $.value.validate(o=>{if(o){const e={id:g.value.length+1,date:new Date().toISOString().split("T")[0],operator:"当前用户",status:"待审核",...v.value};if(M.value==="add")g.value.unshift(e),D.success("添加成功");else{const d=g.value.findIndex(F=>F.id===e.id);d>-1&&(g.value[d]=e,D.success("更新成功"))}V.value=!1}})},fe=async()=>{q.value&&await q.value.validate(o=>{if(o){const e=g.value.find(d=>d.id===i.value.id);e&&(e.status=_.value.result==="通过"?"已审核":"已驳回",e.approvalHistory=e.approvalHistory||[],e.approvalHistory.unshift({date:new Date().toLocaleString(),operator:"当前用户",result:_.value.result,comment:_.value.comment}),D.success("审核提交成功"),k.value=!1)}})};return(o,e)=>{const d=s("el-icon"),F=s("el-card"),ge=s("el-col"),_e=s("el-row"),x=s("el-tag"),S=s("el-input"),m=s("el-button"),w=s("el-table-column"),ye=s("el-table"),be=s("el-pagination"),N=s("el-option"),j=s("el-select"),C=s("el-form-item"),we=s("el-upload"),O=s("el-form"),E=s("el-dialog"),Ce=s("el-timeline-item"),Ve=s("el-timeline"),G=s("el-radio"),ke=s("el-radio-group"),he=Me("loading");return c(),f("div",Re,[l(_e,{gutter:20},{default:a(()=>[(c(),f(z,null,B(W,(t,y)=>l(ge,{span:6,key:y},{default:a(()=>[l(F,{class:"stat-card","body-style":{padding:"20px"}},{default:a(()=>[n("div",Ae,[l(d,{size:24,color:t.color},{default:a(()=>[(c(),T(Ue(t.icon)))]),_:2},1032,["color"])]),n("div",Ie,[n("div",{class:"stat-value",style:Fe({color:t.color})},r(t.value),5),n("div",$e,r(t.title),1)])]),_:2},1024)]),_:2},1024)),64))]),_:1}),l(F,{class:"table-card"},{header:a(()=>[n("div",qe,[n("div",Ee,[e[14]||(e[14]=n("span",{class:"title"},"信息维护记录",-1)),l(x,{type:"info"},{default:a(()=>[u(r(H.value)+" 条记录",1)]),_:1})]),n("div",Le,[l(S,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=t=>U.value=t),placeholder:"搜索关键词",style:{width:"200px","margin-right":"10px"},clearable:"",onClear:P,onKeyup:ze(P,["enter"])},{prefix:a(()=>[l(d,null,{default:a(()=>[l(Q(Se))]),_:1})]),_:1},8,["modelValue"]),l(m,{type:"primary",onClick:ne},{default:a(()=>[l(d,null,{default:a(()=>[l(Q(Te))]),_:1}),e[15]||(e[15]=u("新增记录 "))]),_:1})])])]),default:a(()=>[Be((c(),T(ye,{data:ee.value,style:{width:"100%"},border:"",stripe:""},{default:a(()=>[l(w,{prop:"date",label:"更新日期",width:"120",sortable:""}),l(w,{prop:"type",label:"信息类型",width:"120"},{default:a(({row:t})=>[l(x,{type:ae(t.type)},{default:a(()=>[u(r(t.type),1)]),_:2},1032,["type"])]),_:1}),l(w,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),l(w,{prop:"operator",label:"操作人",width:"120"}),l(w,{prop:"category",label:"分类",width:"120"},{default:a(({row:t})=>[l(x,{type:oe(t.category),effect:"plain"},{default:a(()=>[u(r(t.category),1)]),_:2},1032,["type"])]),_:1}),l(w,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(x,{type:K(t.status)},{default:a(()=>[u(r(t.status),1)]),_:2},1032,["type"])]),_:1}),l(w,{label:"操作",width:"250",fixed:"right"},{default:a(t=>[l(m,{size:"small",onClick:y=>se(t.row)},{default:a(()=>e[16]||(e[16]=[u("编辑")])),_:2},1032,["onClick"]),l(m,{size:"small",type:"success",onClick:y=>ue(t.row)},{default:a(()=>e[17]||(e[17]=[u("查看")])),_:2},1032,["onClick"]),t.row.status==="待审核"?(c(),T(m,{key:0,size:"small",type:"warning",onClick:y=>ie(t.row)},{default:a(()=>e[18]||(e[18]=[u("审核")])),_:2},1032,["onClick"])):R("",!0),l(m,{size:"small",type:"danger",onClick:y=>re(t.row)},{default:a(()=>e[19]||(e[19]=[u("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[he,Z.value]]),n("div",He,[l(be,{"current-page":h.value,"onUpdate:currentPage":e[1]||(e[1]=t=>h.value=t),"page-size":I.value,"onUpdate:pageSize":e[2]||(e[2]=t=>I.value=t),total:H.value,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:de,onCurrentChange:pe},null,8,["current-page","page-size","total"])])]),_:1}),l(E,{title:M.value==="add"?"新增记录":"编辑记录",modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=t=>V.value=t),width:"650px"},{footer:a(()=>[n("span",Ke,[l(m,{onClick:e[7]||(e[7]=t=>V.value=!1)},{default:a(()=>e[22]||(e[22]=[u("取消")])),_:1}),l(m,{type:"primary",onClick:me},{default:a(()=>e[23]||(e[23]=[u("确定")])),_:1})])]),default:a(()=>[l(O,{ref_key:"formRef",ref:$,model:v.value,rules:X,"label-width":"100px"},{default:a(()=>[l(C,{label:"信息类型",prop:"type"},{default:a(()=>[l(j,{modelValue:v.value.type,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value.type=t),placeholder:"请选择信息类型",style:{width:"100%"}},{default:a(()=>[(c(),f(z,null,B(te,t=>l(N,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(C,{label:"标题",prop:"title"},{default:a(()=>[l(S,{modelValue:v.value.title,"onUpdate:modelValue":e[4]||(e[4]=t=>v.value.title=t),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),l(C,{label:"分类",prop:"category"},{default:a(()=>[l(j,{modelValue:v.value.category,"onUpdate:modelValue":e[5]||(e[5]=t=>v.value.category=t),placeholder:"请选择分类",style:{width:"100%"}},{default:a(()=>[(c(),f(z,null,B(le,t=>l(N,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(C,{label:"内容",prop:"content"},{default:a(()=>[l(S,{modelValue:v.value.content,"onUpdate:modelValue":e[6]||(e[6]=t=>v.value.content=t),type:"textarea",rows:6,placeholder:"请输入内容"},null,8,["modelValue"])]),_:1}),l(C,{label:"附件"},{default:a(()=>[l(we,{action:"#","auto-upload":!1,"on-change":ce,"file-list":v.value.attachments},{tip:a(()=>e[21]||(e[21]=[n("div",{class:"el-upload__tip"}," 支持任意格式文件，单个文件不超过10MB ",-1)])),default:a(()=>[l(m,{type:"primary"},{default:a(()=>e[20]||(e[20]=[u("选择文件")])),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),l(E,{title:"信息详情",modelValue:A.value,"onUpdate:modelValue":e[9]||(e[9]=t=>A.value=t),width:"800px"},{default:a(()=>{var t,y;return[i.value?(c(),f("div",Pe,[n("h3",null,r(i.value.title),1),n("div",Ne,[n("span",null,"更新时间："+r(i.value.date),1),n("span",null,"操作人："+r(i.value.operator),1),n("span",null,[e[24]||(e[24]=u("状态： ")),l(x,{type:K(i.value.status)},{default:a(()=>[u(r(i.value.status),1)]),_:1},8,["type"])])]),n("div",je,r(i.value.content),1),(t=i.value.attachments)!=null&&t.length?(c(),f("div",Oe,[e[26]||(e[26]=n("h3",null,"附件列表",-1)),n("div",Ge,[(c(!0),f(z,null,B(i.value.attachments,(b,L)=>(c(),f("div",{key:L,class:"attachment-item"},[n("span",null,r(b.name),1),l(m,{type:"primary",link:"",onClick:Ye=>ve(b)},{default:a(()=>e[25]||(e[25]=[u("下载")])),_:2},1032,["onClick"])]))),128))])])):R("",!0),(y=i.value.approvalHistory)!=null&&y.length?(c(),f("div",Je,[e[27]||(e[27]=n("h3",null,"审核历史",-1)),l(Ve,null,{default:a(()=>[(c(!0),f(z,null,B(i.value.approvalHistory,(b,L)=>(c(),T(Ce,{key:L,type:b.result==="通过"?"success":"danger",timestamp:b.date},{default:a(()=>[n("h4",null,r(b.operator),1),n("p",null,"审核结果："+r(b.result),1),n("p",null,"审核意见："+r(b.comment),1)]),_:2},1032,["type","timestamp"]))),128))]),_:1})])):R("",!0)])):R("",!0)]}),_:1},8,["modelValue"]),l(E,{title:"信息审核",modelValue:k.value,"onUpdate:modelValue":e[13]||(e[13]=t=>k.value=t),width:"500px"},{footer:a(()=>[n("span",Qe,[l(m,{onClick:e[12]||(e[12]=t=>k.value=!1)},{default:a(()=>e[30]||(e[30]=[u("取消")])),_:1}),l(m,{type:"primary",onClick:fe},{default:a(()=>e[31]||(e[31]=[u("确定")])),_:1})])]),default:a(()=>[l(O,{ref_key:"approvalFormRef",ref:q,model:_.value,rules:Y,"label-width":"100px"},{default:a(()=>[l(C,{label:"审核结果",prop:"result"},{default:a(()=>[l(ke,{modelValue:_.value.result,"onUpdate:modelValue":e[10]||(e[10]=t=>_.value.result=t)},{default:a(()=>[l(G,{label:"通过"},{default:a(()=>e[28]||(e[28]=[u("通过")])),_:1}),l(G,{label:"驳回"},{default:a(()=>e[29]||(e[29]=[u("驳回")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(C,{label:"审核意见",prop:"comment"},{default:a(()=>[l(S,{modelValue:_.value.comment,"onUpdate:modelValue":e[11]||(e[11]=t=>_.value.comment=t),type:"textarea",rows:4,placeholder:"请输入审核意见"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},et=xe(We,[["__scopeId","data-v-1f645e84"]]);export{et as default};
